<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html;charset=iso-8859-1" />
<title>Controlling a backup client</title>
<link rel="stylesheet" href="bbstyles.css" type="text/css" />
</head>
<body>
<div align="center">
<div id="header">
<div id="logo">
<img src="images/bblogo.png" alt="logo" height="65" width="331" border="0" vspace="5" align="middle" /> <img src="images/stepahead.png" alt="a step ahead in data security" width="182" height="11" hspace="10" vspace="20" border="0" align="middle" /></div>
</div>
<div id="page">

<h1>Controlling a backup client</h1>

<p>The <tt>bbackupctl</tt> program sends control commands to the <tt>bbackupd</tt>
daemon. It must be run as the same user as the daemon, and there is no exception for
root.</p>

<p>The command line syntax is</p>

<pre>
  /usr/local/bin/bbackupctl [-q] [-c config-file] command
</pre>

<p>The <tt>-q</tt> option reduces the amount of output the program emits, and
<tt>-c</tt> allows an alternative configuration file to be specified.</p>

<p>Valid commands are</p>

<dl>
<dt>terminate
<dd>Stop the <tt>bbackupd</tt> daemon now (equivalent to <tt>kill</tt>)

<dt>reload
<dd>Reload the configuration file (equivalent to <tt>kill -HUP</tt>)

<dt>sync
<dd>Connect to the server and syncronise files now. (See below)
</dl>

<p>It communicates with the server via a UNIX domain socket, specified in
<tt>bbackupd.conf</tt> with the <tt>CommandSocket</tt> directive. This does not
need to be specified, and <tt>bbackupd</tt> will run without the command socket,
but in this case <tt>bbackupctl</tt> will not be able to communicate with the daemon.</p>

<p>Some platforms cannot check the user id of the connecting process, so this
command socket becomes a denial of service security risk. <tt>bbackupd</tt> will
warn you when it starts up if this is the case on your platform, and you should
consider removing the <tt>CommandSocket</tt> directive on these platforms.</p>


<h2>Using bbackupctl to perform snapshots</h2>

<p><tt>bbackupctl</tt>'s main purpose is to implement snapshot based backups,
emulating the behaviour of traditional backup software.</p>

<p>Use <tt>bbackupd-config</tt> to write a configuration file in <tt>snapshot</tt>
mode, and then run the following command as a cron job.</p>

<pre>
  /usr/local/bin/bbackupctl -q sync
</pre>

<p>This will cause the backup daemon to upload all changed files immediately.
<tt>bbackupctl</tt> will exit almost immediately, and will not output anything
unless there is an error.</p>


<p>&nbsp;</p>
<p>&copy; Ben Summers, 2003, 2004</p>
<p>&nbsp;</p>
</div>
</div>
</body>
</html>